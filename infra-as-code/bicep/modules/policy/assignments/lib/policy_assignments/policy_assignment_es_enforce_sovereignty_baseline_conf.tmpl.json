{
  "name": "Enforce-Sovereign-Conf",
  "type": "Microsoft.Authorization/policyAssignments",
  "apiVersion": "2024-04-01",
  "properties": {
    "description": "The Microsoft Cloud for Sovereignty recommends confidential policies to help organizations achieve their sovereignty goals by default denying the creation of resources outside of approved regions, denying resources that are not backed by Azure Confidential Computing, and denying data storage resources that are not using Customer-Managed Keys. More details can be found here: https://aka.ms/SovereigntyBaselinePolicies",
    "displayName": "[Preview]: Sovereignty Baseline - Confidential Policies",
    "notScopes": [],
    "parameters": {
      "allowedResourceTypes": {
        "value": [
          "Microsoft.Attestation/attestationProviders",
          "Microsoft.Compute/availabilitySets",
          "Microsoft.Compute/capacityReservationGroups",
          "Microsoft.Compute/capacityReservationGroups/capacityReservations",
          "Microsoft.Compute/cloudServices",
          "Microsoft.Compute/cloudServices/roles",
          "Microsoft.Compute/cloudServices/roleInstances",
          "Microsoft.Compute/cloudServices/networkInterfaces",
          "Microsoft.Compute/cloudServices/roleInstances/networkInterfaces",
          "Microsoft.Compute/cloudServices/publicIPAddresses",
          "Microsoft.Compute/disks",
          "Microsoft.Compute/diskEncryptionSets",
          "Microsoft.Compute/diskAccesses",
          "Microsoft.Compute/galleries",
          "Microsoft.Compute/galleries/images",
          "Microsoft.Compute/galleries/images/versions",
          "Microsoft.Compute/galleries/applications",
          "Microsoft.Compute/galleries/applications/versions",
          "Microsoft.Compute/hostGroups",
          "Microsoft.Compute/hostGroups/hosts",
          "Microsoft.Compute/images",
          "Microsoft.Compute/locations",
          "Microsoft.Compute/locations/artifactPublishers",
          "Microsoft.Compute/locations/csoperations",
          "Microsoft.Compute/locations/cloudServiceOsVersions",
          "Microsoft.Compute/locations/cloudServiceOsFamilies",
          "Microsoft.Compute/locations/capsoperations",
          "Microsoft.Compute/locations/communityGalleries",
          "Microsoft.Compute/locations/diagnostics",
          "Microsoft.Compute/locations/diagnosticOperations",
          "Microsoft.Compute/locations/diskoperations",
          "Microsoft.Compute/locations/edgeZones",
          "Microsoft.Compute/locations/edgeZones/vmimages",
          "Microsoft.Compute/locations/edgeZones/publishers",
          "Microsoft.Compute/locations/galleries",
          "Microsoft.Compute/locations/logAnalytics",
          "Microsoft.Compute/locations/recommendations",
          "Microsoft.Compute/locations/runCommands",
          "Microsoft.Compute/locations/sharedGalleries",
          "Microsoft.Compute/locations/spotEvictionRates",
          "Microsoft.Compute/locations/spotPriceHistory",
          "Microsoft.Compute/locations/operations",
          "Microsoft.Compute/locations/publishers",
          "Microsoft.Compute/locations/usages",
          "Microsoft.Compute/locations/vmSizes",
          "Microsoft.Compute/locations/virtualMachines",
          "Microsoft.Compute/locations/virtualMachineScaleSets",
          "Microsoft.Compute/operations",
          "Microsoft.Compute/restorePointCollections/restorePoints/diskRestorePoints",
          "Microsoft.Compute/virtualMachines",
          "Microsoft.Compute/virtualMachines/applications",
          "Microsoft.Compute/virtualMachines/extensions",
          "Microsoft.Compute/virtualMachines/metricDefinitions",
          "Microsoft.Compute/virtualMachines/runCommands",
          "Microsoft.Compute/virtualMachineScaleSets",
          "Microsoft.Compute/virtualMachineScaleSets/applications",
          "Microsoft.Compute/virtualMachineScaleSets/extensions",
          "Microsoft.Compute/virtualMachineScaleSets/networkInterfaces",
          "Microsoft.Compute/virtualMachineScaleSets/publicIPAddresses",
          "Microsoft.Compute/virtualMachineScaleSets/virtualMachines",
          "Microsoft.Compute/virtualMachineScaleSets/virtualMachines/extensions",
          "Microsoft.Compute/virtualMachineScaleSets/virtualMachines/networkInterfaces",
          "Microsoft.Compute/restorePointCollections",
          "Microsoft.Compute/restorePointCollections/restorePoints",
          "Microsoft.Compute/proximityPlacementGroups",
          "Microsoft.Compute/sshPublicKeys",
          "Microsoft.Compute/sharedVMImages",
          "Microsoft.Compute/sharedVMImages/versions",
          "Microsoft.Compute/snapshots",
          "Microsoft.ConfidentialLedger/checkNameAvailability",
          "Microsoft.ConfidentialLedger/Ledgers",
          "Microsoft.ConfidentialLedger/Locations",
          "Microsoft.ConfidentialLedger/Locations/operations",
          "Microsoft.ConfidentialLedger/Locations/operationstatuses",
          "Microsoft.ConfidentialLedger/ManagedCCFs",
          "Microsoft.ContainerService/managedClusters",
          "Microsoft.ContainerService/managedClusters/agentPools",
          "Microsoft.HardwareSecurityModules/dedicatedHSMs",
          "Microsoft.HardwareSecurityModules/locations",
          "Microsoft.HardwareSecurityModules/locations/operationResults",
          "Microsoft.HardwareSecurityModules/operations",
          "Microsoft.KeyVault/hsmPools",
          "Microsoft.KeyVault/managedHSMs",
          "Microsoft.KeyVault/locations/managedHsmOperationResults",
          "Microsoft.KeyVault/checkMhsmNameAvailability",
          "Microsoft.KeyVault/checkNameAvailability",
          "Microsoft.KeyVault/deletedManagedHSMs",
          "Microsoft.KeyVault/deletedVaults",
          "Microsoft.KeyVault/locations",
          "Microsoft.KeyVault/locations/deletedManagedHSMs",
          "Microsoft.KeyVault/locations/deletedVaults",
          "Microsoft.KeyVault/locations/notifyNetworkSecurityPerimeterUpdatesAvailable",
          "Microsoft.KeyVault/locations/operationResults",
          "Microsoft.KeyVault/managedHSMs/privateEndpointConnections",
          "Microsoft.KeyVault/operations",
          "Microsoft.KeyVault/vaults",
          "Microsoft.KeyVault/vaults/accessPolicies",
          "Microsoft.KeyVault/vaults/eventGridFilters",
          "Microsoft.KeyVault/vaults/keys",
          "Microsoft.KeyVault/vaults/keys/versions",
          "Microsoft.KeyVault/vaults/privateEndpointConnections",
          "Microsoft.KeyVault/vaults/secrets",
          "Microsoft.Kubernetes/connectedClusters",
          "Microsoft.Kubernetes/locations",
          "Microsoft.Kubernetes/locations/operationStatuses",
          "Microsoft.Kubernetes/registeredSubscriptions",
          "Microsoft.Kubernetes/Operations",
          "Microsoft.KubernetesConfiguration/sourceControlConfigurations",
          "Microsoft.KubernetesConfiguration/extensions",
          "Microsoft.KubernetesConfiguration/fluxConfigurations",
          "Microsoft.KubernetesConfiguration/operations",
          "Microsoft.KubernetesConfiguration/privateLinkScopes",
          "Microsoft.KubernetesConfiguration/privateLinkScopes/privateEndpointConnections",
          "Microsoft.KubernetesConfiguration/privateLinkScopes/privateEndpointConnectionProxies",
          "Microsoft.ManagedIdentity/userAssignedIdentities",
          "Microsoft.Network/ddosProtectionPlans",
          "Microsoft.Network/loadBalancers",
          "Microsoft.Network/networkSecurityGroups",
          "Microsoft.Network/networkInterfaces",
          "Microsoft.Network/privateDnsZones",
          "Microsoft.Network/privateDnsZones/virtualNetworkLinks",
          "Microsoft.Network/privateEndpoints",
          "Microsoft.Network/privateEndpoints/privateDnsZoneGroups",
          "Microsoft.Network/publicIPAddresses",
          "Microsoft.Network/routeTables",
          "Microsoft.Network/virtualNetworks",
          "Microsoft.Network/virtualNetworks/subnets",
          "Microsoft.Resources/deployments",
          "Microsoft.Sql/locations/syncDatabaseIds",
          "Microsoft.Sql/locations/longTermRetentionServers",
          "Microsoft.Sql/locations/longTermRetentionBackups",
          "Microsoft.Sql/locations/longTermRetentionPolicyOperationResults",
          "Microsoft.Sql/locations/longTermRetentionPolicyAzureAsyncOperation",
          "Microsoft.Sql/locations/longTermRetentionBackupOperationResults",
          "Microsoft.Sql/locations/longTermRetentionBackupAzureAsyncOperation",
          "Microsoft.Sql/locations/shortTermRetentionPolicyOperationResults",
          "Microsoft.Sql/locations/shortTermRetentionPolicyAzureAsyncOperation",
          "Microsoft.Sql/locations/managedShortTermRetentionPolicyOperationResults",
          "Microsoft.Sql/locations/managedShortTermRetentionPolicyAzureAsyncOperation",
          "Microsoft.Sql/locations/instanceFailoverGroups",
          "Microsoft.Sql/locations/instanceFailoverGroupAzureAsyncOperation",
          "Microsoft.Sql/locations/instanceFailoverGroupOperationResults",
          "Microsoft.Sql/locations/privateEndpointConnectionProxyOperationResults",
          "Microsoft.Sql/locations/privateEndpointConnectionProxyAzureAsyncOperation",
          "Microsoft.Sql/locations/privateEndpointConnectionOperationResults",
          "Microsoft.Sql/locations/outboundFirewallRulesAzureAsyncOperation",
          "Microsoft.Sql/locations/outboundFirewallRulesOperationResults",
          "Microsoft.Sql/locations/privateEndpointConnectionAzureAsyncOperation",
          "Microsoft.Sql/locations/notifyAzureAsyncOperation",
          "Microsoft.Sql/locations/serverTrustGroups",
          "Microsoft.Sql/locations/serverTrustGroupOperationResults",
          "Microsoft.Sql/locations/serverTrustGroupAzureAsyncOperation",
          "Microsoft.Sql/locations/managedDatabaseMoveOperationResults",
          "Microsoft.Sql/locations/managedDatabaseMoveAzureAsyncOperation",
          "Microsoft.Sql/locations/connectionPoliciesAzureAsyncOperation",
          "Microsoft.Sql/locations/connectionPoliciesOperationResults",
          "Microsoft.Sql/locations/notifyNetworkSecurityPerimeterUpdatesAvailable",
          "Microsoft.Sql/locations/replicationLinksAzureAsyncOperation",
          "Microsoft.Sql/locations/replicationLinksOperationResults",
          "Microsoft.Sql/locations/managedInstanceDtcAzureAsyncOperation",
          "Microsoft.Sql/servers",
          "Microsoft.Sql/servers/advancedThreatProtectionSettings",
          "Microsoft.Sql/servers/advisors",
          "Microsoft.Sql/servers/auditingPolicies",
          "Microsoft.Sql/servers/auditingSettings",
          "Microsoft.Sql/servers/connectionPolicies",
          "Microsoft.Sql/servers/databases",
          "Microsoft.Sql/servers/databases/advisors",
          "Microsoft.Sql/servers/databases/advancedThreatProtectionSettings",
          "Microsoft.Sql/servers/databases/auditingPolicies",
          "Microsoft.Sql/servers/databases/auditingSettings",
          "Microsoft.Sql/servers/databases/backupLongTermRetentionPolicies",
          "Microsoft.Sql/servers/databases/extendedAuditingSettings",
          "Microsoft.Sql/servers/databases/geoBackupPolicies",
          "Microsoft.Sql/servers/databases/ledgerDigestUploads",
          "Microsoft.Sql/servers/databases/securityAlertPolicies",
          "Microsoft.Sql/servers/databases/transparentDataEncryption",
          "Microsoft.Sql/servers/databases/transparentDataEncryption",
          "Microsoft.Sql/servers/databases/vulnerabilityAssessments",
          "Microsoft.Sql/servers/devOpsAuditingSettings",
          "Microsoft.Sql/servers/databases/advancedThreatProtectionSettings",
          "Microsoft.Sql/servers/encryptionProtector",
          "Microsoft.Sql/servers/extendedAuditingSettings",
          "Microsoft.Sql/servers/firewallRules",
          "Microsoft.Sql/servers/keys",
          "Microsoft.Sql/servers/securityAlertPolicies",
          "Microsoft.Sql/servers/sqlVulnerabilityAssessments",
          "Microsoft.Sql/servers/vulnerabilityAssessments"
        ]
      },
      "allowedVirtualMachineSKUs": {
        "value": [
          "Standard_DC1s_v2",
          "Standard_DC2s_v2",
          "Standard_DC4s_v2",
          "Standard_DC8_v2",
          "Standard_DC1s_v3",
          "Standard_DC2s_v3",
          "Standard_DC4s_v3",
          "Standard_DC8s_v3",
          "Standard_DC16s_v3",
          "Standard_DC24s_v3",
          "Standard_DC32s_v3",
          "Standard_DC48s_v3",
          "Standard_DC1ds_v3",
          "Standard_DC2ds_v3",
          "Standard_DC4ds_v3",
          "Standard_DC8ds_v3",
          "Standard_DC16ds_v3",
          "Standard_DC24ds_v3",
          "Standard_DC32ds_v3",
          "Standard_DC48ds_v3",
          "Standard_DC2ads_v5",
          "Standard_DC2as_v5",
          "Standard_DC4ads_v5",
          "Standard_DC4as_v5",
          "Standard_DC8ads_v5",
          "Standard_DC8as_v5",
          "Standard_DC16ads_v5",
          "Standard_DC16as_v5",
          "Standard_DC32ads_v5",
          "Standard_DC32as_v5",
          "Standard_DC48ads_v5",
          "Standard_DC48as_v5",
          "Standard_DC64ads_v5",
          "Standard_DC64as_v5",
          "Standard_DC96ads_v5",
          "Standard_DC96as_v5",
          "Standard_EC2ads_v5",
          "Standard_EC2as_v5",
          "Standard_EC4ads_v5",
          "Standard_EC4as_v5",
          "Standard_EC8ads_v5",
          "Standard_EC8as_v5",
          "Standard_EC16ads_v5",
          "Standard_EC16as_v5",
          "Standard_EC20ads_v5",
          "Standard_EC20as_v5",
          "Standard_EC32ads_v5",
          "Standard_EC32as_v5",
          "Standard_EC48ads_v5",
          "Standard_EC48as_v5",
          "Standard_EC64ads_v5",
          "Standard_EC64as_v5",
          "Standard_EC96ads_v5",
          "Standard_EC96as_v5",
          "Standard_EC96iads_v5",
          "Standard_EC96ias_v5"
        ]
      },
      "effect": {
        "value": "Deny"
      },
      "listOfAllowedLocations": {
        "value": [
          "australiacentral",
          "australiacentral2",
          "australiaeast",
          "australiasoutheast",
          "brazilsouth",
          "brazilsoutheast",
          "brazilus",
          "canadacentral",
          "canadaeast",
          "centralindia",
          "centralus",
          "centraluseuap",
          "eastasia",
          "eastus",
          "eastus2",
          "eastus2euap",
          "eastusstg",
          "francecentral",
          "francesouth",
          "germanynorth",
          "germanywestcentral",
          "israelcentral",
          "italynorth",
          "japaneast",
          "japanwest",
          "jioindiacentral",
          "jioindiawest",
          "koreacentral",
          "koreasouth",
          "northcentralus",
          "northeurope",
          "norwayeast",
          "norwaywest",
          "polandcentral",
          "qatarcentral",
          "southafricanorth",
          "southafricawest",
          "southcentralus",
          "southcentralusstg",
          "southeastasia",
          "southindia",
          "swedencentral",
          "switzerlandnorth",
          "switzerlandwest",
          "uaecentral",
          "uaenorth",
          "uksouth",
          "ukwest",
          "westcentralus",
          "westeurope",
          "westindia",
          "westus",
          "westus2",
          "westus3"
        ]
      }
    },
    "policyDefinitionId": "/providers/Microsoft.Authorization/policySetDefinitions/03de05a4-c324-4ccd-882f-a814ea8ab9ea",
    "scope": null,
    "enforcementMode": "Default"
  },
  "location": null,
  "identity": {
    "type": "None"
  }
}
